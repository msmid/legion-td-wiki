<div>
  <div nz-card-grid class="row">
    <div>
      <h3
        *ngIf="withModal; else basicTitle"
        (click)="showDetailModal()"
        class="text-capitalize clickable"
      >
        {{ unit.name }}
      </h3>
      <ng-template #basicTitle>
        <h3 class="text-capitalize">
          {{ unit.name }}
        </h3>
      </ng-template>
    </div>

    <div>
      <span><i nz-icon nzType="dollar" nzTheme="twotone"></i></span>
      <span>{{ unit.gold_cost }}</span>
      <span>&nbsp;({{ unit.food_cost }})</span>
    </div>
  </div>

  <div nz-card-grid class="row">
    <div>
      <ng-container *ngTemplateOutlet="defense"></ng-container>
    </div>

    <div>
      <span>
        <i nz-icon nzType="heart" nzTheme="twotone"></i>
      </span>
      <span class="mr-4">{{ unit.hit_points }}</span>

      <ng-container *ngIf="unit.mana">
        <span>
          <i nz-icon nzType="heart" nzTheme="twotone"></i>
        </span>
        <span>{{ unit.mana }}</span>
      </ng-container>
    </div>
  </div>

  <div nz-card-grid class="row">
    <div>
      <ng-container *ngTemplateOutlet="attack"></ng-container>
    </div>

    <div>
      <span>
        <i nz-icon nzType="thunderbolt" nzTheme="twotone"></i>
      </span>
      <span class="mr-4">{{ unit.base_min_hit }}&nbsp;-&nbsp;{{ unit.base_max_hit }}</span>
    </div>
  </div>

  <div nz-card-grid class="row">
    <div>
      <span class="text-capitalize"
        >{{ unit.attack_speed_class }}&nbsp;({{ unit.attack_speed }})</span
      >
    </div>

    <div>
      <span class="text-capitalize">{{ unit.melee_or_ranged }}&nbsp;({{ unit.range }})</span>
    </div>
  </div>

  <div *ngIf="unit.abilities" nz-card-grid [ngStyle]="gridStyle">
    <span>
      <i nz-icon nzType="fire" nzTheme="twotone"></i>
    </span>
    <span *ngFor="let ability of unit.abilities; let i = index" class="mr-2">
      <div class="text-capitalize" nzColor="default" nz-tooltip>
        {{ ability }}
      </div>
    </span>
  </div>
</div>

<ng-template #attack>
  <img nz-tooltip src="assets/attack_{{ unit.attack_type }}.png" />

  <ng-template #tooltip>
    <span class="d-block">{{ unit.attack_type }}</span>
    <hr />
    <span *ngFor="let armor of unit.attack_effectiveness_order" class="d-block">
      {{ armor }}&nbsp;{{ attackMatrix[unit.attack_type][armor] }}%
    </span>
  </ng-template>
</ng-template>

<ng-template #defense>
  <img nz-tooltip src="assets/defense_{{ unit.defense_type }}.png" />

  <ng-template #tooltip>
    <span class="d-block">{{ unit.defense_type }}</span>
    <hr />
    <span *ngFor="let attack of unit.defense_effectiveness_order" class="d-block">
      {{ attack }}&nbsp;{{ attackMatrix[attack][unit.defense_type] }}%
    </span>
  </ng-template>
</ng-template>

<ng-template #extraHeaderTemp>
  <span><i nz-icon nzType="dollar" nzTheme="twotone"></i></span>
  <span>{{ unit.gold_cost }}</span>
  <span>&nbsp;({{ unit.food_cost }})</span>
</ng-template>

<ng-container *ngIf="withModal">
  <app-unit-detail-modal [unit]="unit" [(isVisible)]="showModal"></app-unit-detail-modal>
</ng-container>
